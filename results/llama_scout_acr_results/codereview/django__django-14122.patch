{
  "patch": "diff --git a/django/db/models/sql/compiler.py b/django/db/models/sql/compiler.py\nindex 850734709d..a2697b6658 100644\n--- a/django/db/models/sql/compiler.py\n+++ b/django/db/models/sql/compiler.py\n@@ -129,7 +129,11 @@ class SQLCompiler:\n             # Skip References to the select clause, as all expressions in the\n             # select clause are already part of the group by.\n             if not is_ref:\n-                expressions.extend(expr.get_group_by_cols())\n+                # Check if the expression is a field reference\n+                if isinstance(expr, F):\n+                    is_ref = expr.refs\n+                if not is_ref:\n+                    expressions.extend(expr.get_group_by_cols())\n         having_group_by = self.having.get_group_by_cols() if self.having else ()\n         for expr in having_group_by:\n             expressions.append(expr)\n@@ -285,7 +289,7 @@ class SQLCompiler:\n             ordering = self.query.order_by\n         elif self.query.get_meta().ordering:\n             ordering = self.query.get_meta().ordering\n-            self._meta_ordering = ordering\n+            self._meta_ordering = [f.attname for f in self.query.get_meta().get_fields()]\n         else:\n             ordering = []\n         if self.query.standard_ordering:\n"
}