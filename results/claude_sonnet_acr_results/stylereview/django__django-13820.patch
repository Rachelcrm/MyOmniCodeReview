{
  "patch": "diff --git a/django/db/migrations/loader.py b/django/db/migrations/loader.py\nindex 95a5062ec9..7218e24627 100644\n--- a/django/db/migrations/loader.py\n+++ b/django/db/migrations/loader.py\n@@ -49,6 +49,8 @@ class MigrationLoader:\n         self.applied_migrations = None\n         self.ignore_no_migrations = ignore_no_migrations\n         self.replace_migrations = replace_migrations\n+        self.unmigrated_apps = set()\n+        self.migrated_apps = set()\n         if load:\n             self.build_graph()\n \n@@ -82,7 +84,7 @@ class MigrationLoader:\n             except ModuleNotFoundError as e:\n                 if (\n                     (explicit and self.ignore_no_migrations) or\n-                    (not explicit and MIGRATIONS_MODULE_NAME in e.name.split('.'))\n+                    (not explicit and MIGRATIONS_MODULE_NAME in str(e.name).split('.'))\n                 ):\n                     self.unmigrated_apps.add(app_config.label)\n                     continue\n@@ -174,8 +176,8 @@ class MigrationLoader:\n                 if self.ignore_no_migrations:\n                     return None\n                 else:\n-                    raise ValueError(\"Dependency on app with no migrations: %s\" % key[0])\n-        raise ValueError(\"Dependency on unknown app: %s\" % key[0])\n+                    raise ValueError(\"Dependency on app with no migrations: %s\" % key[0]) from None\n+        raise ValueError(\"Dependency on unknown app: %s\" % key[0]) from None\n \n     def add_internal_dependencies(self, key, migration):\n         \"\"\"\n"
}