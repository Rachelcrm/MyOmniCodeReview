{
  "patch": "diff --git a/django/contrib/admin/options.py b/django/contrib/admin/options.py\nindex 69a5fbf389..db433b4c98 100644\n--- a/django/contrib/admin/options.py\n+++ b/django/contrib/admin/options.py\n@@ -115,6 +115,7 @@ class BaseModelAdmin(metaclass=forms.MediaDefiningClass):\n     view_on_site = True\n     show_full_result_count = True\n     checks_class = BaseModelAdminChecks\n+    inlines = ()\n \n     def check(self, **kwargs):\n         return self.checks_class().check(self, **kwargs)\n@@ -126,6 +127,7 @@ class BaseModelAdmin(metaclass=forms.MediaDefiningClass):\n         for k, v in self.formfield_overrides.items():\n             overrides.setdefault(k, {}).update(v)\n         self.formfield_overrides = overrides\n+        self.admin_site = None\n \n     def formfield_for_dbfield(self, db_field, request, **kwargs):\n         \"\"\"\n@@ -158,7 +160,7 @@ class BaseModelAdmin(metaclass=forms.MediaDefiningClass):\n             # extra HTML -- the \"add other\" interface -- to the end of the\n             # rendered output. formfield can be None if it came from a\n             # OneToOneField with parent_link=True or a M2M intermediary.\n-            if formfield and db_field.name not in self.raw_id_fields:\n+            if formfield and db_field.name not in self.raw_id_fields and self.admin_site is not None:\n                 related_modeladmin = self.admin_site._registry.get(db_field.remote_field.model)\n                 wrapper_kwargs = {}\n                 if related_modeladmin:\n@@ -184,7 +186,7 @@ class BaseModelAdmin(metaclass=forms.MediaDefiningClass):\n         # For any other type of field, just call its formfield() method.\n         return db_field.formfield(**kwargs)\n \n-    def formfield_for_choice_field(self, db_field, request, **kwargs):\n+    def formfield_for_choice_field(self, db_field, request, **kwargs):  # pylint: disable=unused-argument\n         \"\"\"\n         Get a form Field for a database Field that has declared choices.\n         \"\"\"\n@@ -208,11 +210,12 @@ class BaseModelAdmin(metaclass=forms.MediaDefiningClass):\n         ordering.  Otherwise don't specify the queryset, let the field decide\n         (return None in that case).\n         \"\"\"\n-        related_admin = self.admin_site._registry.get(db_field.remote_field.model)\n-        if related_admin is not None:\n-            ordering = related_admin.get_ordering(request)\n-            if ordering is not None and ordering != ():\n-                return db_field.remote_field.model._default_manager.using(db).order_by(*ordering)\n+        if self.admin_site is not None:\n+            related_admin = self.admin_site._registry.get(db_field.remote_field.model)\n+            if related_admin is not None:\n+                ordering = related_admin.get_ordering(request)\n+                if ordering is not None and ordering != ():\n+                    return db_field.remote_field.model._default_manager.using(db).order_by(*ordering)\n         return None\n \n     def formfield_for_foreignkey(self, db_field, request, **kwargs):\n@@ -221,7 +224,7 @@ class BaseModelAdmin(metaclass=forms.MediaDefiningClass):\n         \"\"\"\n         db = kwargs.get('using')\n \n-        if 'widget' not in kwargs:\n+        if 'widget' not in kwargs and self.admin_site is not None:\n             if db_field.name in self.get_autocomplete_fields(request):\n                 kwargs['widget'] = AutocompleteSelect(db_field.remote_field, self.admin_site, using=db)\n             elif db_field.name in self.raw_id_fields:\n@@ -250,10 +253,11 @@ class BaseModelAdmin(metaclass=forms.MediaDefiningClass):\n         db = kwargs.get('using')\n \n         autocomplete_fields = self.get_autocomplete_fields(request)\n-        if db_field.name in autocomplete_fields:\n-            kwargs['widget'] = AutocompleteSelectMultiple(db_field.remote_field, self.admin_site, using=db)\n-        elif db_field.name in self.raw_id_fields:\n-            kwargs['widget'] = widgets.ManyToManyRawIdWidget(db_field.remote_field, self.admin_site, using=db)\n+        if self.admin_site is not None:\n+            if db_field.name in autocomplete_fields:\n+                kwargs['widget'] = AutocompleteSelectMultiple(db_field.remote_field, self.admin_site, using=db)\n+            elif db_field.name in self.raw_id_fields:\n+                kwargs['widget'] = widgets.ManyToManyRawIdWidget(db_field.remote_field, self.admin_site, using=db)\n         elif db_field.name in [*self.filter_vertical, *self.filter_horizontal]:\n             kwargs['widget'] = widgets.FilteredSelectMultiple(\n                 db_field.verbose_name,\n@@ -273,7 +277,7 @@ class BaseModelAdmin(metaclass=forms.MediaDefiningClass):\n             form_field.help_text = format_lazy('{} {}', help_text, msg) if help_text else msg\n         return form_field\n \n-    def get_autocomplete_fields(self, request):\n+    def get_autocomplete_fields(self, request):  # pylint: disable=unused-argument\n         \"\"\"\n         Return a list of ForeignKey and/or ManyToMany fields which should use\n         an autocomplete widget.\n@@ -286,7 +290,7 @@ class BaseModelAdmin(metaclass=forms.MediaDefiningClass):\n \n         if callable(self.view_on_site):\n             return self.view_on_site(obj)\n-        elif self.view_on_site and hasattr(obj, 'get_absolute_url'):\n+        elif self.view_on_site is True and hasattr(obj, 'get_absolute_url'):\n             # use the ContentType lookup if view_on_site is True\n             return reverse('admin:view_on_site', kwargs={\n                 'content_type_id': get_content_type_for_model(obj).pk,\n@@ -300,9 +304,11 @@ class BaseModelAdmin(metaclass=forms.MediaDefiningClass):\n         try:\n             return mark_safe(self.empty_value_display)\n         except AttributeError:\n-            return mark_safe(self.admin_site.empty_value_display)\n+            if self.admin_site is not None:\n+                return mark_safe(self.admin_site.empty_value_display)\n+            return mark_safe('-')\n \n-    def get_exclude(self, request, obj=None):\n+    def get_exclude(self, request, obj=None):  # pylint: disable=unused-argument\n         \"\"\"\n         Hook for specifying exclude.\n         \"\"\"\n@@ -318,6 +324,15 @@ class BaseModelAdmin(metaclass=forms.MediaDefiningClass):\n         form = self._get_form_for_get_fields(request, obj)\n         return [*form.base_fields, *self.get_readonly_fields(request, obj)]\n \n+    def _get_form_for_get_fields(self, request, obj):\n+        \"\"\"\n+        Return a form instance that is used by get_fields().\n+        This method must be implemented by subclasses.\n+        \"\"\"\n+        raise NotImplementedError(\n+            'subclasses of BaseModelAdmin must provide a _get_form_for_get_fields() method'\n+        )\n+\n     def get_fieldsets(self, request, obj=None):\n         \"\"\"\n         Hook for specifying fieldsets.\n"
}