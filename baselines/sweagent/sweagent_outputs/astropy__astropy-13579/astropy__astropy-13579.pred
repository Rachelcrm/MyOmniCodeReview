{"model_name_or_path": "sweagent_outputs", "instance_id": "astropy__astropy-13579", "model_patch": "\r\ndiff --git a/astropy/wcs/tests/test_wcs.py b/astropy/wcs/tests/test_wcs.py\r\nindex 80f9c38..ceffbbe 100644\r\n--- a/astropy/wcs/tests/test_wcs.py\r\n+++ b/astropy/wcs/tests/test_wcs.py\r\n@@ -1578,3 +1578,52 @@ def test_swapaxes_same_val_roundtrip():\r\n \r\n     # check round-tripping:\r\n     assert np.allclose(w.wcs_world2pix([val_ref], 0)[0], imcoord, rtol=0, atol=1e-8)\r\n+\r\n+\r\n+def test_sliced_low_level_wcs_world_to_pixel():\r\n+    import numpy as np\r\n+    import astropy.wcs\r\n+    from astropy.coordinates import SkyCoord\r\n+    import astropy.units as u\r\n+\r\n+    nx = 100\r\n+    ny = 25\r\n+    nz = 2\r\n+    wcs_header = {\r\n+        'WCSAXES': 3,\r\n+        'CRPIX1': (nx + 1)/2,\r\n+        'CRPIX2': (ny + 1)/2,\r\n+        'CRPIX3': 1.0,\r\n+        'PC1_1': 0.0,\r\n+        'PC1_2': -1.0,\r\n+        'PC1_3': 0.0,\r\n+        'PC2_1': 1.0,\r\n+        'PC2_2': 0.0,\r\n+        'PC2_3': -1.0,\r\n+        'CDELT1': 5,\r\n+        'CDELT2': 5,\r\n+        'CDELT3': 0.055,\r\n+        'CUNIT1': 'arcsec',\r\n+        'CUNIT2': 'arcsec',\r\n+        'CUNIT3': 'Angstrom',\r\n+        'CTYPE1': 'HPLN-TAN',\r\n+        'CTYPE2': 'HPLT-TAN',\r\n+        'CTYPE3': 'WAVE',\r\n+        'CRVAL1': 0.0,\r\n+        'CRVAL2': 0.0,\r\n+        'CRVAL3': 1.05,\r\n+    }\r\n+    fits_wcs = astropy.wcs.WCS(header=wcs_header)\r\n+\r\n+    pt = SkyCoord(Tx=0*u.arcsec, Ty=0*u.arcsec, frame=astropy.wcs.utils.wcs_to_celestial_frame(fits_wcs))\r\n+    px, py, pz = fits_wcs.world_to_pixel(pt, 1.05*u.angstrom)\r\n+\r\n+    assert np.isclose(px, 49.5)\r\n+    assert np.isclose(py, 12.0)\r\n+\r\n+    ll_sliced_wcs = astropy.wcs.wcsapi.SlicedLowLevelWCS(fits_wcs, 0)\r\n+    hl_sliced_wcs = astropy.wcs.wcsapi.HighLevelWCSWrapper(ll_sliced_wcs)\r\n+    px_sliced, py_sliced = hl_sliced_wcs.world_to_pixel(pt)\r\n+\r\n+    assert np.isclose(px_sliced, 49.5)\r\n+    assert np.isclose(py_sliced, 12.0)\r\n\\ No newline at end of file\r\n"}