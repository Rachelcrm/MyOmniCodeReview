{"model_name_or_path": "sweagent_outputs", "instance_id": "astropy__astropy-13398", "model_patch": "\r\ndiff --git a/astropy/coordinates/tests/test_icrs_observed_transformations.py b/astropy/coordinates/tests/test_icrs_observed_transformations.py\r\nindex 23150b7..884f1a7 100644\r\n--- a/astropy/coordinates/tests/test_icrs_observed_transformations.py\r\n+++ b/astropy/coordinates/tests/test_icrs_observed_transformations.py\r\n@@ -76,3 +76,31 @@ def test_icrs_hadec_consistency():\r\n     roundtrip = icoo.transform_to(hd_frame).transform_to(\r\n         CIRS()).transform_to(icoo)\r\n     assert_allclose(roundtrip.separation_3d(icoo), 0*u.mm, atol=1*u.mm)\r\n+def test_itrs_observed_consistency():\r\n+    \"\"\"\r\n+    Check ITRS<->AltAz and ITRS<->HADec for consistency.\r\n+    \"\"\"\r\n+    usph = golden_spiral_grid(200)\r\n+    dist = np.linspace(0.5, 1, len(usph)) * u.km * 1e5\r\n+    icoo = SkyCoord(x=usph.lon, y=usph.lat, z=dist, representation_type='cartesian', frame='itrs')\r\n+\r\n+    observer = EarthLocation(28*u.deg, 23*u.deg, height=2000.*u.km)\r\n+    obstime = Time('J2010')\r\n+    aa_frame = AltAz(obstime=obstime, location=observer)\r\n+    hd_frame = HADec(obstime=obstime, location=observer)\r\n+\r\n+    # check that ITRS-AltAz and ITRS->AltAz are consistent\r\n+    aa1 = icoo.transform_to(aa_frame)\r\n+    assert_allclose(aa1.separation_3d(icoo), 0*u.mm, atol=1*u.mm)\r\n+\r\n+    # check that ITRS-HADec and ITRS->HADec are consistent\r\n+    hd1 = icoo.transform_to(hd_frame)\r\n+    assert_allclose(hd1.separation_3d(icoo), 0*u.mm, atol=1*u.mm)\r\n+\r\n+    # check roundtrip for AltAz\r\n+    roundtrip_aa = icoo.transform_to(aa_frame).transform_to(icoo)\r\n+    assert_allclose(roundtrip_aa.separation_3d(icoo), 0*u.mm, atol=1*u.mm)\r\n+\r\n+    # check roundtrip for HADec\r\n+    roundtrip_hd = icoo.transform_to(hd_frame).transform_to(icoo)\r\n+    assert_allclose(roundtrip_hd.separation_3d(icoo), 0*u.mm, atol=1*u.mm)\r\n"}