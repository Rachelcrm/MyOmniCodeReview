
diff --git a/astropy/modeling/tests/test_separable.py b/astropy/modeling/tests/test_separable.py
index 8dfe5c8..a3a0c85 100644
--- a/astropy/modeling/tests/test_separable.py
+++ b/astropy/modeling/tests/test_separable.py
@@ -148,3 +148,25 @@ def test_custom_model_separable():
 
     assert not model_c().separable
     assert np.all(separability_matrix(model_c()) == [True, True])
+def test_separability_matrix_nested_compound_models():
+    cm = models.Linear1D(10) & models.Linear1D(5)
+    expected_matrix_cm = np.array([[True, False], [False, True]])
+    assert np.array_equal(separability_matrix(cm), expected_matrix_cm)
+
+    complex_model = models.Pix2Sky_TAN() & models.Linear1D(10) & models.Linear1D(5)
+    expected_matrix_complex = np.array([
+        [True, True, False, False],
+        [True, True, False, False],
+        [False, False, True, False],
+        [False, False, False, True]
+    ])
+    assert np.array_equal(separability_matrix(complex_model), expected_matrix_complex)
+
+    nested_model = models.Pix2Sky_TAN() & cm
+    expected_matrix_nested = np.array([
+        [True, True, False, False],
+        [True, True, False, False],
+        [False, False, True, True],
+        [False, False, True, True]
+    ])
+    assert np.array_equal(separability_matrix(nested_model), expected_matrix_nested)
\ No newline at end of file
